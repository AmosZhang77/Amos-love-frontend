<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>window | amos-love-frontend</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/logo.jpg">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.bda44f48.css" as="style"><link rel="preload" href="/assets/js/app.7c756303.js" as="script"><link rel="preload" href="/assets/js/2.abc0edee.js" as="script"><link rel="preload" href="/assets/js/17.b9f6285d.js" as="script"><link rel="prefetch" href="/assets/js/10.a87010c8.js"><link rel="prefetch" href="/assets/js/11.02c7cf69.js"><link rel="prefetch" href="/assets/js/12.bcd4f9da.js"><link rel="prefetch" href="/assets/js/13.95cbb481.js"><link rel="prefetch" href="/assets/js/14.e8895777.js"><link rel="prefetch" href="/assets/js/15.cc35c7d0.js"><link rel="prefetch" href="/assets/js/16.f26b69be.js"><link rel="prefetch" href="/assets/js/18.e9f620cd.js"><link rel="prefetch" href="/assets/js/19.b65f0201.js"><link rel="prefetch" href="/assets/js/20.d6cb4150.js"><link rel="prefetch" href="/assets/js/21.ba8768d7.js"><link rel="prefetch" href="/assets/js/22.7a2010fd.js"><link rel="prefetch" href="/assets/js/23.3d0edf6e.js"><link rel="prefetch" href="/assets/js/24.880bafc5.js"><link rel="prefetch" href="/assets/js/25.769f6514.js"><link rel="prefetch" href="/assets/js/26.bb4ee09d.js"><link rel="prefetch" href="/assets/js/27.09e7772a.js"><link rel="prefetch" href="/assets/js/28.8ec94852.js"><link rel="prefetch" href="/assets/js/29.37fa2210.js"><link rel="prefetch" href="/assets/js/3.aa494763.js"><link rel="prefetch" href="/assets/js/30.d246d0ba.js"><link rel="prefetch" href="/assets/js/31.76e86474.js"><link rel="prefetch" href="/assets/js/32.37469f4b.js"><link rel="prefetch" href="/assets/js/33.5914a1b7.js"><link rel="prefetch" href="/assets/js/34.d317b44b.js"><link rel="prefetch" href="/assets/js/35.eb920473.js"><link rel="prefetch" href="/assets/js/36.1ef1b7b3.js"><link rel="prefetch" href="/assets/js/37.83fa7dd8.js"><link rel="prefetch" href="/assets/js/38.0f46719d.js"><link rel="prefetch" href="/assets/js/39.71e32b03.js"><link rel="prefetch" href="/assets/js/4.22cf8280.js"><link rel="prefetch" href="/assets/js/40.f16cd174.js"><link rel="prefetch" href="/assets/js/41.180a9313.js"><link rel="prefetch" href="/assets/js/42.81f34ad3.js"><link rel="prefetch" href="/assets/js/43.747a1b3a.js"><link rel="prefetch" href="/assets/js/44.bdc1c393.js"><link rel="prefetch" href="/assets/js/45.f5d623a4.js"><link rel="prefetch" href="/assets/js/46.b43414ec.js"><link rel="prefetch" href="/assets/js/47.ccaf5d78.js"><link rel="prefetch" href="/assets/js/48.06ed3c38.js"><link rel="prefetch" href="/assets/js/49.520000bb.js"><link rel="prefetch" href="/assets/js/5.e15b4983.js"><link rel="prefetch" href="/assets/js/50.54bb9d58.js"><link rel="prefetch" href="/assets/js/51.620d5d6a.js"><link rel="prefetch" href="/assets/js/52.1f636435.js"><link rel="prefetch" href="/assets/js/53.acd4ff3b.js"><link rel="prefetch" href="/assets/js/54.78ac858e.js"><link rel="prefetch" href="/assets/js/55.44b1df0b.js"><link rel="prefetch" href="/assets/js/56.ded729af.js"><link rel="prefetch" href="/assets/js/57.16c2a939.js"><link rel="prefetch" href="/assets/js/58.5963eadb.js"><link rel="prefetch" href="/assets/js/59.c12eeabe.js"><link rel="prefetch" href="/assets/js/6.78fca4e5.js"><link rel="prefetch" href="/assets/js/60.8f4be675.js"><link rel="prefetch" href="/assets/js/61.77abfa35.js"><link rel="prefetch" href="/assets/js/62.b867f1ce.js"><link rel="prefetch" href="/assets/js/63.0972ab8f.js"><link rel="prefetch" href="/assets/js/64.8bd0fb2e.js"><link rel="prefetch" href="/assets/js/65.ff39a49e.js"><link rel="prefetch" href="/assets/js/66.8752c1f7.js"><link rel="prefetch" href="/assets/js/67.a1647207.js"><link rel="prefetch" href="/assets/js/68.0a6f8e98.js"><link rel="prefetch" href="/assets/js/69.b4bc28d8.js"><link rel="prefetch" href="/assets/js/7.8be22781.js"><link rel="prefetch" href="/assets/js/70.78f9a20a.js"><link rel="prefetch" href="/assets/js/71.b0d6aab5.js"><link rel="prefetch" href="/assets/js/72.1c82f8c4.js"><link rel="prefetch" href="/assets/js/73.1e5e2dd3.js"><link rel="prefetch" href="/assets/js/74.165dabac.js"><link rel="prefetch" href="/assets/js/75.5ef2b9e5.js"><link rel="prefetch" href="/assets/js/76.6d1877f7.js"><link rel="prefetch" href="/assets/js/77.f82f34e3.js"><link rel="prefetch" href="/assets/js/78.e3970456.js"><link rel="prefetch" href="/assets/js/79.67112695.js"><link rel="prefetch" href="/assets/js/8.dc19eca6.js"><link rel="prefetch" href="/assets/js/80.6e70b738.js"><link rel="prefetch" href="/assets/js/81.f38ebd86.js"><link rel="prefetch" href="/assets/js/82.e7fbf134.js"><link rel="prefetch" href="/assets/js/83.f8f9f572.js"><link rel="prefetch" href="/assets/js/84.40c937c5.js"><link rel="prefetch" href="/assets/js/85.7fd30468.js"><link rel="prefetch" href="/assets/js/86.a09db6ad.js"><link rel="prefetch" href="/assets/js/87.50a4924a.js"><link rel="prefetch" href="/assets/js/88.569a7028.js"><link rel="prefetch" href="/assets/js/9.6ead2a49.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bda44f48.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="amos-love-frontend" class="logo"> <span class="site-name can-hide">amos-love-frontend</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/html/" class="nav-link">
  Notes
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/html/" class="nav-link">
  Notes
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/guide/" class="sidebar-link">导读</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/html/" class="sidebar-heading clickable"><span>HTML</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group depth-0"><a href="/css/" class="sidebar-heading clickable"><span>CSS</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/css/base/" class="sidebar-heading clickable open"><span>base</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/css/base/dimensions/" class="sidebar-link">dimensions</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/css/font/" class="sidebar-heading clickable"><span>font</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/css/sass/" class="sidebar-heading clickable"><span>sass</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/css/less/" class="sidebar-heading clickable"><span>less</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/css/css_module/" class="sidebar-link">css module</a></li><li><a href="/css/css_fn/" class="sidebar-link">css fn</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/js/" class="sidebar-heading clickable router-link-active open"><span>JS</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><a href="/js/base/" class="sidebar-heading clickable"><span>js</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/base/data_type/" class="sidebar-link">date type</a></li><li><a href="/js/base/object/" class="sidebar-link">object</a></li><li><a href="/js/base/array/" class="sidebar-link">array</a></li><li><a href="/js/base/string/" class="sidebar-link">string</a></li><li><a href="/js/base/class/" class="sidebar-link">class</a></li><li><a href="/js/base/set/" class="sidebar-link">set</a></li><li><a href="/js/base/base_api/" class="sidebar-link">base api</a></li><li><a href="/js/base/request/" class="sidebar-link">request</a></li><li><a href="/js/base/coding/" class="sidebar-link">coding</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/js/dom/" class="sidebar-heading clickable router-link-active open"><span>dom</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/dom/input/" class="sidebar-link">input</a></li><li><a href="/js/dom/window/" aria-current="page" class="active sidebar-link">window</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/dom/window/#window" class="sidebar-link">window</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/dom/window/#禁止alert" class="sidebar-link">禁止alert</a></li><li class="sidebar-sub-header"><a href="/js/dom/window/#progressive-web-apps-pwa" class="sidebar-link">Progressive Web Apps PWA</a></li><li class="sidebar-sub-header"><a href="/js/dom/window/#drag-drop" class="sidebar-link">drag drop</a></li></ul></li></ul></li><li><a href="/js/dom/video/" class="sidebar-link">video</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/js/function_collection/" class="sidebar-heading clickable"><span>function collection</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/function_collection/input/" class="sidebar-link">input</a></li><li><a href="/js/function_collection/date/" class="sidebar-link">date</a></li></ul></section></li><li><a href="/js/code_style/" class="sidebar-link">code style</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/react/" class="sidebar-heading clickable"><span>react</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/react/base/" class="sidebar-heading clickable open"><span>base</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/base/api/" class="sidebar-link">api</a></li><li><a href="/react/base/fn/" class="sidebar-link">fn</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/react/source_code/" class="sidebar-heading clickable"><span>source code</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/react/project_learning/" class="sidebar-heading clickable"><span>project learning</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/react/third_party/" class="sidebar-link">third party</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/engineering/" class="sidebar-heading clickable"><span>engineering</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/engineering/npm/" class="sidebar-link">npm</a></li><li><a href="/engineering/webpack/" class="sidebar-link">webpack</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/engineering/git/" class="sidebar-heading clickable"><span>git</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/third_party/" class="sidebar-heading clickable"><span>third party</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/third_party/echart/" class="sidebar-link">EChart</a></li><li><a href="/third_party/jquery/" class="sidebar-link">jquery</a></li></ul></section></li><li><a href="/markdown/" class="sidebar-link">MARKDOWN</a></li><li><section class="sidebar-group depth-0"><a href="/linux/" class="sidebar-heading clickable"><span>linux</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/linux/base/" class="sidebar-link">linux base</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/editor/" class="sidebar-heading clickable"><span>editor</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/editor/webstorm/" class="sidebar-link">webstorm</a></li><li><a href="/editor/vscode/" class="sidebar-link">vscode</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/interview/" class="sidebar-heading clickable"><span>面试需背（你懂的）</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/base/" class="sidebar-link">基础</a></li><li><a href="/interview/question/" class="sidebar-link">question</a></li></ul></section></li><li><a href="/en/" class="sidebar-link">EN</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="window"><a href="#window" class="header-anchor">#</a> window</h2> <h3 id="禁止alert"><a href="#禁止alert" class="header-anchor">#</a> 禁止alert</h3> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">alert</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="progressive-web-apps-pwa"><a href="#progressive-web-apps-pwa" class="header-anchor">#</a> Progressive Web Apps PWA</h3> <p>浏览器在浏览器之外，推送操作的通知</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//检查是否支持</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'Notification'</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span> navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Display the UI to let the user toggle notifications</span>
<span class="token punctuation">}</span>
<span class="token comment">//检查权限</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>Notification<span class="token punctuation">.</span>permission <span class="token operator">===</span> <span class="token string">&quot;granted&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* do our magic */</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Notification<span class="token punctuation">.</span>permission <span class="token operator">===</span> <span class="token string">&quot;blocked&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//用户拒绝推送 </span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">//显示提示</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">displayNotification</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Notification<span class="token punctuation">.</span>permission <span class="token operator">==</span> <span class="token string">'granted'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">getRegistration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">reg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        body<span class="token operator">:</span> <span class="token string">'Here is a notification body!'</span><span class="token punctuation">,</span><span class="token comment">//主体内容</span>
        icon<span class="token operator">:</span> <span class="token string">'images/example.png'</span><span class="token punctuation">,</span> <span class="token comment">// 通知图标</span>
        vibrate<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//震动，先100ms然后暂停50ms最后在震动100ms</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//通知数据，用于人机交互</span>
          dateOfArrival<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          primaryKey<span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      reg<span class="token punctuation">.</span><span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'Hello world!'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token comment">// 弹出通知命令</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><img src="/assets/img/notice.db4d1118.png" width="429" height="213"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//监听关闭通知事件，比如安卓上面滑动通知关闭。</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'notificationclose'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> notification <span class="token operator">=</span> e<span class="token punctuation">.</span>notification
  <span class="token keyword">var</span> primaryKey <span class="token operator">=</span> notification<span class="token punctuation">.</span>data<span class="token punctuation">.</span>primaryKey
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Closed notification: '</span> <span class="token operator">+</span> primaryKey<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//监听通知的点击事件</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'notificationclick'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> notification <span class="token operator">=</span> e<span class="token punctuation">.</span>notification
  <span class="token keyword">var</span> primaryKey <span class="token operator">=</span> notification<span class="token punctuation">.</span>data<span class="token punctuation">.</span>primaryKey
  <span class="token keyword">var</span> action <span class="token operator">=</span> e<span class="token punctuation">.</span>action

  <span class="token keyword">if</span> <span class="token punctuation">(</span>action <span class="token operator">===</span> <span class="token string">'close'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    notification<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 点关闭通知就关闭通知</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    clients<span class="token punctuation">.</span><span class="token function">openWindow</span><span class="token punctuation">(</span><span class="token string">'http://www.example.com'</span><span class="token punctuation">)</span> <span class="token comment">// 这里试过，能打开，但是是本网站的根目录，有待研究</span>
    notification<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 点其他地方，先打开网站，再关闭通知</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="drag-drop"><a href="#drag-drop" class="header-anchor">#</a> drag drop</h3> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tree</span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filter-tree<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoTree<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultProps<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">default-expand-all</span>
      <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoTree<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@node-drag-start</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>elDragStart<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:draggable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>draggable<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@node-drag-end</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>elHandleDragEnd<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:allow-drag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>elAllowDrag<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:allow-drop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>elAllowDrop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tree</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>control t1c<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t1c<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@dragover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>allowDrop<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@drop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dropV<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'dashboard'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      videoTree<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
          label<span class="token operator">:</span> <span class="token string">'阳光花园'</span><span class="token punctuation">,</span>
          children<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              id<span class="token operator">:</span> <span class="token string">'1.1'</span><span class="token punctuation">,</span>
              label<span class="token operator">:</span> <span class="token string">'东门'</span><span class="token punctuation">,</span>
              ch<span class="token operator">:</span> <span class="token string">'rtmp://58.200.131.2:1935/livetv/hunantv'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              id<span class="token operator">:</span> <span class="token string">'1.2'</span><span class="token punctuation">,</span>
              label<span class="token operator">:</span> <span class="token string">'南门'</span><span class="token punctuation">,</span>
              ch<span class="token operator">:</span> <span class="token string">'rtmp://live.hkstv.hk.lxdns.com/live/hks1'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span>
          label<span class="token operator">:</span> <span class="token string">'宝辰怡景苑'</span><span class="token punctuation">,</span>
          children<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              id<span class="token operator">:</span> <span class="token string">'2.1'</span><span class="token punctuation">,</span>
              label<span class="token operator">:</span> <span class="token string">'东门'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              id<span class="token operator">:</span> <span class="token string">'2.2'</span><span class="token punctuation">,</span>
              label<span class="token operator">:</span> <span class="token string">'南门'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      defaultProps<span class="token operator">:</span> <span class="token punctuation">{</span>
        children<span class="token operator">:</span> <span class="token string">'children'</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">'label'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 视频</span>
      draggable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// element，tree是否可以拖拽选项</span>
      draggingNote<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// element，tree是否正在被拖拽</span>
      startNode<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 树上起始拖拽点</span>
    <span class="token function">elDragStart</span> <span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>draggingNote <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment">// 记录有拖拽起点并且是正确的起点</span>

      <span class="token comment">// 记录拖拽起点树组件节点信息</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>startNode <span class="token operator">=</span> node
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> event<span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">elHandleDragEnd</span> <span class="token punctuation">(</span><span class="token parameter">draggingNode<span class="token punctuation">,</span> dropNode<span class="token punctuation">,</span> dropType<span class="token punctuation">,</span> ev</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span>
      <span class="token comment">// 此需求不支持树节点之间的拖拽移动。当树节点为拖拽结束点时，清楚拖拽开始标志位</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>_this<span class="token punctuation">.</span>draggingNote <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tree drag end: '</span><span class="token punctuation">,</span> dropNode <span class="token operator">&amp;&amp;</span> dropNode<span class="token punctuation">.</span>label<span class="token punctuation">,</span> dropType<span class="token punctuation">,</span> ev<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">elAllowDrag</span> <span class="token punctuation">(</span><span class="token parameter">draggingNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'draggingNode'</span><span class="token punctuation">,</span> draggingNode<span class="token punctuation">)</span>
      <span class="token comment">// 树的第二层子节点才允许拖拽</span>
      <span class="token keyword">return</span> draggingNode<span class="token punctuation">.</span>level <span class="token operator">!==</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">elAllowDrop</span> <span class="token punctuation">(</span><span class="token parameter">draggingNode<span class="token punctuation">,</span> dropNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log(draggingNode, dropNode, type)</span>
      <span class="token comment">// 禁止树节点为拖拽终点，防止树节点拖拽交换移动</span>
      <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>dropNode<span class="token punctuation">.</span>level <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">||</span> dropNode<span class="token punctuation">.</span>level <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 需求目的地，允许拖拽放置</span>
    <span class="token function">allowDrop</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这里需求只想拖拽播放，并不是真的把dom移动过去</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 需求目的地，拖拽放置的事件</span>
    <span class="token function">dropV</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>draggingNote<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>draggingNote <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>draggingNote <span class="token operator">=</span> <span class="token boolean">false</span>
       <span class="token comment">// 播放对应视频代码</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/20/2021, 4:33:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js/dom/input/" class="prev">
        input
      </a></span> <span class="next"><a href="/js/dom/video/">
        video
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7c756303.js" defer></script><script src="/assets/js/2.abc0edee.js" defer></script><script src="/assets/js/17.b9f6285d.js" defer></script>
  </body>
</html>
